version: '2'
services:
  nginx:
      #build: ./nginx.mmfei
      build: ./nginx
      container_name: nginx
      # network_mode: "host"
      volumes:
        - ~/Work:/data1
        - ~/Work/docker_php_nginx_mysql_redis_memcached/nginx/sites-enabled:/usr/local/nginx/conf/sites-enabled
      restart: always
      ports:
        - "80:80"
        - "1935:1935"
        # - "9000:9000"
        # - "3306:3306"
        # - "6379:6379"
      links:
        - php:php
        - php7:php7
        # - pmd.dev.com:pmd.dev.com
        # - adnew.devmobvista.com:adnew.devmobvista.com
        - mysql:mysql
        - redis:redis
        - memcached:memcached
        # - elasticsearch1:elasticsearch1
        # - elasticsearch2:elasticsearch
        # - rabbitmq:rabbitmq
  php:
      build: ./php5
      container_name: php
      # network_mode: "host"
      volumes:
        - ~/Work:/data1
        - ~/Work/docker_php_nginx_mysql_redis_memcached/nginx/sites-enabled:/usr/local/nginx/conf/sites-enabled
      restart: always
      ports:
        - "9000:9000"
        - "8080:80"
        # - "19000:19000"
  php7:
      build: ./php7
      container_name: php7
      # network_mode: "host"
      volumes:
        - ~/Work:/data1
        - ~/Work/docker_php_nginx_mysql_redis_memcached/php7/sites-enabled:/usr/local/nginx/conf/sites-enabled
      restart: always
      ports:
        - "9007:9000"
        - "8087:80"
        # - "19000:19000"
  # pmd.dev.com
  #     build: ./php5
  #     container_name: pmd.dev.com
  #     # network_mode: "host"
  #     volumes:
  #       - ~/Work:/data1
  #     restart: always
  #     ports:
  #       - "9001:9000"
  # adnew.devmobvista.com:
  #     build: ./php5
  #     container_name: adnew.devmobvista.com
  #     # network_mode: "host"
  #     volumes:
  #       - ~/Work:/data1
  #     restart: always
  #     ports:
  #       - "9002:9000"
  mysql:
      build: ./mysql/file
      container_name: mysql
      # network_mode: "host"
      volumes:
        - ~/Work/data/mysql:/var/lib/mysql
        - ~/Work/log:/data1/log
      environment:
        MYSQL_ROOT_PASSWORD: 123456
      restart: always
      ports:
        - "3306:3306"
  redis:
      build: ./redis/file
      container_name: redis
      # network_mode: "host"
      volumes:
        - ~/Work/data/redis:/data
        - ~/Work/log:/data1/log
      restart: always
      ports:
        - "6379:6379"
  memcached:
    image: memcached
    container_name: memcached
    ports:
      - "11211:11211"
  # rabbitmq:
  #   image: rabbitmq:3.6.1-management
  #   container_name: rabbitmq
  #   ports:
  #     - "15672:15672"
  #     - "5672:5672"

#   elasticsearch1:
#     image: docker.elastic.co/elasticsearch/elasticsearch:5.5.2
#     container_name: elasticsearch1
#     environment:
#       - cluster.name=docker-cluster
#       - bootstrap.memory_lock=true
#       - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
#     ulimits:
#       memlock:
#         soft: -1
#         hard: -1
#     mem_limit: 1g
#     volumes:
#       - ~/Work/elasticsearch/data/1:/usr/share/elasticsearch/data
#     ports:
#       - 9200:9200
#     networks:
#       - esnet
#   elasticsearch2:
#     image: docker.elastic.co/elasticsearch/elasticsearch:5.5.2
#     environment:
#       - cluster.name=docker-cluster
#       - bootstrap.memory_lock=true
#       - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
#       - "discovery.zen.ping.unicast.hosts=elasticsearch1"
#     ulimits:
#       memlock:
#         soft: -1
#         hard: -1
#     mem_limit: 1g
#     volumes:
#       - ~/Work/elasticsearch/data/2:/usr/share/elasticsearch/data
#     networks:
#       - esnet

# networks:
#   esnet:

  # elasticsearch:
  #   image: elasticsearch:latest
  #   container_name: elasticsearch
  #   volumes:
  #     - ~/Work/elasticsearch/data:/usr/share/elasticsearch/data
  #   environment:
  #     - ES_CLUSTERNAME=mydevelastic
  #   command: elasticsearch -Des.config=/usr/share/elasticsearch/data/elasticsearch.yml
  #   ports:
  #     - "9200:9200"
  #     - "9300:9300"

  # kibana-frontend:
  #   image: kibana:latest
  #   container_name: kibana-frontend
  #   ports:
  #     - "5601:5601"
  #   links:
  #     - elasticsearch:elasticsearch
      
  # logstash-central:
  #   image: logstash:latest
  #   container_name: logstash-central
  #   ports:
  #     - "25826:25826"
  #     - "25826:25826/udp"
  #   volumes:
  #     - ~/Work/logstash/conf:/conf
  #   command: logstash -f /conf/central.conf
  #   links:
  #     - redis:redis
  #     - elasticsearch:db

  # logstash-agent:
  #   image: logstash:latest
  #   container_name: logstash-agent
  #   ports:
  #     - "25827:25827"
  #     - "25827:25827/udp"
  #   volumes:
  #     - ~/Work/logstash/conf:/conf
  #   command: logstash -f /conf/agent.conf
  #   links:
  #     - redis:redis

